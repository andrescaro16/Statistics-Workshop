---
title: "DIANA_MARIA_ARANGO_BOTERO_-_ANDRÉS_JULIAN_CARO_RESTREPO"
authors: Andres Julian Caro Restrepo, Juan Esteban Avendaño Castaño, Julian Andrés
  Romero Hinestroza, Andrés Prada Rodríguez
date: "2023-10-27"
output:
  html_document: default
  pdf_document: default
---

# Bloque 1

## Problema 1

Cargar en archivo csv

```{r}
ventypub <- read.csv("../Databases/ventaypub.csv"); ventypub
```

**Grafico de dispersión**

```{r}
plot(ventypub$Publicidad, ventypub$Ventas, main = "Dispesión", xlab = "Publicidad", ylab = "Ventas")
```

Hay una correlación positiva entre las dos variables, lo que significa que a medida que aumentan los costos de publicidad, también lo hacen las ventas. Sin embargo, la relación no es lineal, hay algunos valores atípicos. Esto signiifica que la publicidad aumenta las ventas, pero también hay otros factores que influyen y esto provoca que el aumento en ventas no justfique la cantidad que se gasta en publicidad.

```{r}
# Calcular la regresión lineal
n <- nrow(ventypub)
mean_x <- mean(ventypub$Publicidad)
mean_y <- mean(ventypub$Ventas)

# Calcular los coeficientes de la regresión lineal
beta_1 <- sum((ventypub$Publicidad - mean_x) * (ventypub$Ventas - mean_y)) / sum((ventypub$Publicidad - mean_x)^2)
beta_0 <- mean_y - beta_1 * mean_x

# Imprimir los resultados
cat("Coeficiente beta_0 (Intercepto):", round(beta_0, 4), "\n")
cat("Coeficiente beta_1 (Publicidad):", round(beta_1, 4), "\n")
```

La venta variable o adicional es beta_1 lo que quiere decir que cada que aumenta en 1 la publicidad las ventas aumentan en 0.2018.

```{r}
# Correlación entre variables
correlacion <- cor(ventypub$Publicidad, ventypub$Ventas)

# Imprimimos los resultados
print(paste0("Correlación entre Publicidad y Ventas: ", round(correlacion, 4)))
```

```{r}
# Calculamos la regresión lineal con lm
mod = lm(Ventas ~ Publicidad, data = ventypub);

# Sacamos los coeficientes de la regresión lineal
beta_0 <- coef(mod)["(Intercept)"]
beta_1 <- coef(mod)["Publicidad"]

# Imprimimos los resultados
print(paste0("Coeficiente beta_0 (Intercept): ", round(beta_0, 4)))
print(paste0("Coeficiente beta_1 (Publicidad): ", round(beta_1, 4)))
```

**Fórmula del modelo:**\
Y = Beta0 + Beta1 · X + Epsilon

-   Y es la variable de respuesta (en este caso, las ventas).

-   X es la variable predictora (los gastos en publicidad).

-   Beta0 es la ordenada al origen (el valor de Y cuando X es 0).

-   Beta1​ es la pendiente de la línea de regresión (el cambio en Y por unidad de cambio en X).

-   Epsilon representa el error, es decir, la diferencia entre la predicción del modelo y el valor real de Y.

Entonces nuestra formula quedaría de la forma:

Ventas = Beta0​ + Beta1 ​⋅ Publicidad + Epsilon

Usando lm se llega al mismo lado que usando las formulas del principio de minimos cuadrados, lo que nos quiere decir que son equivalentes.

Varianza:

```{r}
# Obtener los residuos del modelo
residuos <- resid(mod)

# Calcular la varianza de los residuos (s^2)
varianza_residuos <- sum(residuos^2) / (length(residuos) - 2)

# Mostrar el resultado
cat("Estimación de s^2 (varianza de los residuos):", round(varianza_residuos, 2), "\n")
```

```{r}
# Resumen del modelo lineal
summary(mod)
```

[Insertar inferencia]

[Insertar "¿El ajuste del modelo lineal es sólido?"...]

¿Cuál es el ingreso por ventas si se tiene un costo de publicidad de 22 millones de pesos?

```{r}
# Definimos el nuevo dato para la predicción
nuevo_dato <- data.frame(Publicidad = 22)

# Predecimos el ingreso por ventas
prediccion <- predict(mod, newdata = nuevo_dato)

# Mostramos el resultado
print(paste("El ingreso por ventas proyectado es:", round(prediccion, 2), "millones de pesos"))
```

# Bloque 2

## Problema 2

```{r}
# Estimación puntual de la desviación estándar
desviacion_estandar <- sd(residuos)

# Mostrar el resultado
cat("Estimación puntual de la desviación estándar:", round(desviacion_estandar, 2), "\n")
```

Análisis de linealidad:

```{r}
# Gráfico de dispersión entre las variables predictoras y los residuos
plot(ventypub$Publicidad, residuos, main = "Análisis de Linealidad", xlab = "Publicidad", ylab = "Residuos")
```

Análisis de homocedasticidad

```{r}
# Gráfico de dispersión entre los valores ajustados y los residuos estandarizados
plot(fitted(mod), rstandard(mod), main = "Análisis de Homocedasticidad", xlab = "Valores Ajustados", ylab = "Residuos Estandarizados")
```

Gráfico de normalidad de los residuos estandarizados

```{r}
# Gráfico de cuantiles cuantiles para evaluar la normalidad de los residuos estandarizados
qqnorm(rstandard(mod))
qqline(rstandard(mod))
```

Contraste de hipótesis sobre normalidad

```{r}
# Prueba de normalidad de Shapiro-Wilk
shapiro_test <- shapiro.test(residuos)
shapiro_test
```

Intervalo de confianza del 95% para la normalidad

```{r}
# Intervalo de confianza del 95% para la normalidad
conf_int_normalidad <- c(qnorm(0.025), qnorm(1 - 0.025))
conf_int_normalidad
```
